<%- include ../header.ejs %>

<h1 class="deep-orange-text text-lighten-1 center"> Hotel Search</h1>
<div class="container">
    <div class="row">
        <!-- <p id="cityResult"></p> -->
        <form class="col s12">
            <div class="row">
                <div class="input-field col s11">
                    <input id="cityResult" type="text" class="validate" placeholder="City, State">
                    <label class="active" for="cityResult">Current Location</label>
                </div>
                <div class="input-field col s1">
                    <button onclick="geoFindMe()" class="btn waves-effect waves-light" type="submit" name="action"><i class="material-icons">near_me</i>
                    </button><p id="out"></p>
                </div>
            </div>
            <div class="row">
                <div class="input-field col s6">
                    <input id="dep_date" type="text" class="datepicker" placeholder="DD/MM/YY">
                    <label for="dep_date">Check-In</label>
                </div>
                <div class="input-field col s6">
                    <input id="ret_date" type="text" class="datepicker" placeholder="DD/MM/YY">
                    <label for="ret_date">Check-Out</label>
                </div>
            </div>
        <div class="row">
            <div class="input-field col s6">
                <select>
                    <option value="" disabled selected>Number of Guests</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                </select>
                <label>Guests</label>
            </div>
        </div>
        <div class="row">
            <div class="input-field col s6">
                <button class="btn waves-effect waves-light btn-large" type="submit" name="action">Search
                    <i class="material-icons right"></i>
                </button>
            </div>
        </div>
        </form>
    </div>
</div>  

<!-- geolocator test -->
 <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
<script type="text/javascript"> 
  var geocoder;

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
} 
//Get the latitude and the longitude;
function successFunction(position) {
    var lat = position.coords.latitude;
    var lng = position.coords.longitude;
    codeLatLng(lat, lng)
}

function errorFunction(){
    alert("Geocoder failed");
}

  function initialize() {
    geocoder = new google.maps.Geocoder();



  }

  function codeLatLng(lat, lng) {

    var latlng = new google.maps.LatLng(lat, lng);
    geocoder.geocode({'latLng': latlng}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
      console.log(results)
        if (results[3]) {
         //formatted address
         var cityResult = document.getElementById("cityResult");cityResult.value = results[3].formatted_address;
        // //find country name
        //      for (var i=0; i<results[0].address_components.length; i++) {
        //     for (var b=0;b<results[0].address_components[i].types.length;b++) {

        //     //there are different types that might hold a city admin_area_lvl_1 usually does in come cases looking for sublocality type will be more appropriate
        //         if (results[0].address_components[i].types[b] == "administrative_area_level_1") {
        //             //this is the object you are looking for
        //             city= results[0].address_components[i];
        //             break;
        //         }
        //     }
        // }
        //city data
        // alert(city.short_name + " ")


        } else {
          alert("No results found");
        }
      } else {
        alert("Geocoder failed due to: " + status);
      }
    });
  }
</script> 
</head> 
<body onload="initialize()">  



 <script>
    $('.datepicker').pickadate({
    selectMonths: true, // Creates a dropdown to control month
    selectYears: 2, // Creates a dropdown of 2 years to control year,
    today: 'Today',
    clear: 'Clear',
    close: 'Ok',
    closeOnSelect: false // Close upon selecting a date,
  });
//geolocator
function geoFindMe() {
  var output = document.getElementById("out");

  if (!navigator.geolocation){
    output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
    return;
  }

  function success(position) {
    var latitude  = position.coords.latitude;
    var longitude = position.coords.longitude;

    output.innerHTML = '<p>Latitude is ' + latitude + '° <br>Longitude is ' + longitude + '°</p>';

    var img = new Image();
    img.src = "https://maps.googleapis.com/maps/api/staticmap?center=" + latitude + "," + longitude + "&zoom=13&size=300x300&sensor=false";

    output.appendChild(img);
  }

  function error() {
    output.innerHTML = "Unable to retrieve your location";
  }

  output.innerHTML = "<p>Locating…</p>";

  navigator.geolocation.getCurrentPosition(success, error);
}
</script> 

<script>
    $(document).ready(function() {
    $('select').material_select();
  });

</script>
<%- include ../footer.ejs %>